<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./css/index.css" />
    <link rel="stylesheet" href="./css/inputnumber.css" />
  </head>
  <body>
    <div class="app-container" id="app">
      <!--È°∂ÈÉ®banner-->
      <div class="banner-box"><img src="./img/fruit.jpg" /></div>
      <!--Èù¢ÂåÖÂ±ë-->
      <div class="breadcrumb">
        <span>üè†</span>
        /
        <span>Ë¥≠Áâ©ËΩ¶</span>
      </div>
      <!--Ë¥≠Áâ©ËΩ¶‰∏ª‰Ωì-->
      <div class="main" v-if="fruitList.length > 0">
        <div class="thead">
          <!--Â§¥ÈÉ®-->
          <div class="tr">
            <div class="th">ÈÄâ‰∏≠</div>
            <div class="th th-pic">ÂõæÁâá</div>
            <div class="th">Âçï‰ª∑</div>
            <div class="th num-th">‰∏™Êï∞</div>
            <div class="th">Â∞èËÆ°</div>
            <div class="th">Êìç‰Ωú</div>
          </div>
          <!--Ë∫´‰Ωì-->
          <div class="tbody">
            <div
              class="tr"
              v-for="(item,index) in fruitList"
              :key="item.id"
              v-bind:class="{ active : item.isChecked }"
            >
              <div class="td">
                <input type="checkbox" v-model="item.isChecked" />
              </div>
              <div class="td">
                <img :src="item.icon" alt="" />
              </div>
              <div class="td">{{item.price}}</div>
              <div class="td">
                <div class="my-input-number">
                  <button
                    class="decrease"
                    :disabled="item.num <= 1"
                    v-on:click="sub(item.id)"
                  >
                    -
                  </button>
                  <span class="my-input__inner">{{ item.num }}</span>
                  <button class="increase" @click="add(item.id)">+</button>
                </div>
              </div>
              <div class="td">{{item.price * item.num}}</div>
              <div class="td"><button @click="del(item.id)">Âà†Èô§</button></div>
            </div>
          </div>
        </div>
        <!--Â∫ïÈÉ®-->
        <div class="bottom">
          <!--ÂÖ®ÈÄâ-->
          <label class="check-all">
            <input type="checkbox" v-model="isAll" />
            ÂÖ®ÈÄâ
          </label>
          <div class="right-box">
            <!--ÊâÄÊúâÂïÜÂìÅÊÄª‰ª∑-->
            <span class="price-box">ÊÄª‰ª∑&nbsp;&nbsp;:&nbsp;&nbsp;¬•&nbsp;<span class="price">{{ totalPrice }}</span></span>
            <button class="pay">ÁªìÁÆó({{totalCount}})</button>
          </div>
        </div>
      </div>
      <!-- Á©∫ËΩ¶ -->
      <div class="empty" v-else>üõíÁ©∫Á©∫Â¶Ç‰πü</div>
    </div>
    <script src="../js/vue.js"></script>
    <script>
      const app = new Vue({
        el: "#app",
        data() {
          return {
            // Ê∞¥ÊûúÂàóË°®
            fruitList: [
              {
                id: 1,
                icon: "./img/ÁÅ´ÈæôÊûú.png",
                isChecked: true,
                num: 2,
                price: 6,
              },
              {
                id: 2,
                icon: "./img/ËçîÊûù.png",
                isChecked: false,
                num: 7,
                price: 20,
              },
              {
                id: 3,
                icon: "./img/Ê¶¥Ëé≤.png",
                isChecked: false,
                num: 3,
                price: 40,
              },
              {
                id: 4,
                icon: "./img/È∏≠Ê¢®.png",
                isChecked: true,
                num: 10,
                price: 3,
              },
              {
                id: 5,
                icon: "./img/Ê®±Ê°É.png",
                isChecked: false,
                num: 20,
                price: 34,
              },
            ],
          };
        },
        computed: {
          isAll: {
            get() {
              return this.fruitList.every((item) => item.isChecked);
            },
            set(value) {
              this.fruitList.forEach((item) => {
                item.isChecked = value;
              });
            },
          },
          //ÁªüËÆ°ÈÄâ‰∏≠ÁöÑÊÄªÊï∞
          totalCount(){
            return this.fruitList.reduce((total,item)=>{
              if(item.isChecked){
                total += item.num
              }
              return total
            },0)
          },
          totalPrice(){
            return this.fruitList.reduce((sum,item)=>{
              if(item.isChecked){
                sum += item.num * item.price
              }
              return sum
            },0)
          }
        },
        methods: {
          del(id) {
            this.fruitList = this.fruitList.filter((item) => item.id !== id);
          },
          add(id) {
            //Ê†πÊçÆidÊâæÂà∞ÂØπÂ∫îÁöÑÂïÜÂìÅ
            const fruit = this.fruitList.find((item) => item.id === id);
            //Êï∞ÈáèÂä†1
            fruit.num++;
          },
          sub(id) {
            //Ê†πÊçÆidÊâæÂà∞ÂØπÂ∫îÁöÑÂïÜÂìÅ
            const fruit = this.fruitList.find((item) => item.id === id);
            //Êï∞ÈáèÂáè1
            if (fruit.num > 1) {
              fruit.num--;
            }
          },
        },
      });
    </script>
  </body>
</html>
